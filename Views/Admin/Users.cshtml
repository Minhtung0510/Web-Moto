@model IEnumerable<MotoBikeStore.Models.User>
@{ Layout="~/Views/Shared/_Layout.cshtml"; ViewData["Title"]="Quản lý người dùng"; }

<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3><i class="fas fa-users me-2"></i>Quản lý người dùng</h3>
    <a href="/Admin" class="btn btn-outline-secondary">
      <i class="fas fa-arrow-left me-2"></i>Về Dashboard
    </a>
  </div>

  @if(TempData["SuccessMessage"] != null)
  {
    <div class="alert alert-success alert-dismissible">
      @TempData["SuccessMessage"]
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
  }

  <div class="card">
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-hover mb-0">
          <thead class="table-light">
            <tr>
              <th>ID</th>
              <th>Họ tên</th>
              <th>Email</th>
              <th>SĐT</th>
              <th>Vai trò</th>
              <th>Ngày tạo</th>
              <th>Trạng thái</th>
              <th class="text-center">Thao tác</th>
            </tr>
          </thead>
          <tbody>
            @foreach(var user in Model)
            {
              <tr class="@(user.IsActive ? "" : "table-secondary")">
                <td><strong>#@user.Id</strong></td>
                <td>@user.FullName</td>
                <td>@user.Email</td>
                <td>@(user.Phone ?? "N/A")</td>
                <td>
                  <span class="badge bg-@(user.Role == "Admin" ? "danger" : "primary")">
                    @user.Role
                  </span>
                </td>
                <td>@user.CreatedAt.ToString("dd/MM/yyyy")</td>
                <td>
                  @if(user.IsActive)
                  {
                    <span class="badge bg-success">Hoạt động</span>
                  }
                  else
                  {
                    <span class="badge bg-secondary">Đã khóa</span>
                  }
                </td>
                <td class="text-center">
                  <a href="/Admin/UserDetail/@user.Id" class="btn btn-sm btn-outline-primary">
                    <i class="fas fa-eye"></i>
                  </a>
                  <a href="/Admin/ToggleUserStatus/@user.Id" class="btn btn-sm btn-outline-warning">
                    <i class="fas fa-@(user.IsActive ? "lock" : "unlock")"></i>
                  </a>
                </td>
              </tr>
            }
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Statistics -->
  <div class="row g-3 mt-4">
    <div class="col-md-4">
      <div class="card bg-primary text-white">
        <div class="card-body">
          <h6>Tổng người dùng</h6>
          <h2>@Model.Count()</h2>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card bg-success text-white">
        <div class="card-body">
          <h6>Khách hàng</h6>
          <h2>@Model.Count(u => u.Role == "Customer")</h2>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card bg-danger text-white">
        <div class="card-body">
          <h6>Quản trị viên</h6>
          <h2>@Model.Count(u => u.Role == "Admin")</h2>
        </div>
      </div>
    </div>
  </div>
</div>