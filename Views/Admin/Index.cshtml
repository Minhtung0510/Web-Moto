@{ Layout="~/Views/Shared/_Layout.cshtml"; ViewData["Title"]="Admin Dashboard"; }

<div class="container py-4">
  <h3 class="mb-4"><i class="fas fa-tachometer-alt me-2"></i>Dashboard Quản trị</h3>
  
  <!-- Statistics Cards -->
  <div class="row g-3 mb-4">
    <div class="col-md-3">
      <div class="card bg-primary text-white">
        <div class="card-body">
          <h6 class="card-title"><i class="fas fa-shopping-cart me-2"></i>Tổng đơn hàng</h6>
          <h2 class="mb-0">@ViewBag.TotalOrders</h2>
        </div>
      </div>
    </div>
    
    <div class="col-md-3">
      <div class="card bg-success text-white">
        <div class="card-body">
          <h6 class="card-title"><i class="fas fa-dollar-sign me-2"></i>Tổng doanh thu</h6>
          <h2 class="mb-0">@(((decimal)ViewBag.TotalRevenue / 1000000).ToString("N1"))M₫</h2>
        </div>
      </div>
    </div>
    
    <div class="col-md-3">
      <div class="card bg-info text-white">
        <div class="card-body">
          <h6 class="card-title"><i class="fas fa-box me-2"></i>Sản phẩm</h6>
          <h2 class="mb-0">@ViewBag.TotalProducts</h2>
        </div>
      </div>
    </div>
    
    <div class="col-md-3">
      <div class="card bg-warning text-white">
        <div class="card-body">
          <h6 class="card-title"><i class="fas fa-users me-2"></i>Khách hàng</h6>
          <h2 class="mb-0">@ViewBag.TotalCustomers</h2>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Monthly Stats -->
  <div class="row g-3 mb-4">
    <div class="col-md-6">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Doanh thu tháng này</h5>
          <h2 class="text-success">@(((decimal)ViewBag.MonthlyRevenue / 1000000).ToString("N1"))M₫</h2>
        </div>
      </div>
    </div>
    
    <div class="col-md-6">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Đơn hàng chờ xử lý</h5>
          <h2 class="text-danger">@ViewBag.PendingOrders</h2>
          <a href="/Admin/Orders?status=Pending" class="btn btn-sm btn-outline-primary mt-2">
            Xem chi tiết
          </a>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Quick Actions -->
  <div class="row g-3 mb-4">
    <div class="col-md-12">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title mb-3">Thao tác nhanh</h5>
          <div class="btn-group" role="group">
            <a href="/Admin/Orders" class="btn btn-outline-primary">
              <i class="fas fa-list me-2"></i>Quản lý đơn hàng
            </a>
            <a href="/Products" class="btn btn-outline-success">
              <i class="fas fa-box me-2"></i>Quản lý sản phẩm
            </a>
            <a href="/Coupons" class="btn btn-outline-warning">
              <i class="fas fa-ticket-alt me-2"></i>Quản lý khuyến mãi
            </a>
            <a href="/Admin/Reports" class="btn btn-outline-info">
              <i class="fas fa-chart-bar me-2"></i>Báo cáo doanh thu
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Top Products -->
  <div class="row g-3 mb-4">
    <div class="col-md-6">
      <div class="card">
        <div class="card-header bg-white">
          <h5 class="mb-0"><i class="fas fa-fire text-danger me-2"></i>Top sản phẩm bán chạy</h5>
        </div>
        <div class="card-body">
          <table class="table table-sm">
            <thead>
              <tr><th>Sản phẩm</th><th class="text-end">Đã bán</th></tr>
            </thead>
            <tbody>
              @foreach(var item in ViewBag.TopProducts)
              {
                <tr>
                  <td>@item.Product.Name</td>
                  <td class="text-end"><span class="badge bg-success">@item.TotalSold</span></td>
                </tr>
              }
            </tbody>
          </table>
        </div>
      </div>
    </div>
    
    <!-- Recent Orders -->
    <div class="col-md-6">
      <div class="card">
        <div class="card-header bg-white">
          <h5 class="mb-0"><i class="fas fa-clock me-2"></i>Đơn hàng gần đây</h5>
        </div>
        <div class="card-body">
          <table class="table table-sm">
            <thead>
              <tr><th>Mã ĐH</th><th>Khách hàng</th><th>Trạng thái</th></tr>
            </thead>
            <tbody>
              @foreach(var order in ViewBag.RecentOrders)
              {
                <tr>
                  <td><a href="/Admin/OrderDetail/@order.Id">#@order.Id</a></td>
                  <td>@order.CustomerName</td>
                  <td>
                    <span class="badge bg-@(order.Status switch {
                      "Pending" => "warning",
                      "Confirmed" => "info",
                      "Shipping" => "primary",
                      "Delivered" => "success",
                      "Cancelled" => "danger",
                      _ => "secondary"
                    })">@order.Status</span>
                  </td>
                </tr>
              }
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>